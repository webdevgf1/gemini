<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANI BACKROOMS - Anime AI Interface</title>
    <link rel="icon" type="image/png" href="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/686b0ce13d8af2c84afaa7d9_New%20Project%20-%202025-07-07T005256.247.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Berkeley+Mono:wght@400;700&family=Space+Mono:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --ani-pink: #ff69b4;
            --ani-purple: #9d4edd;
            --ani-cyan: #00f5ff;
            --grok-orange: #ff6b35;
            --deep-black: #0a0a0a;
            --void-gray: #1a1a1a;
            --ani-white: #ffffff;
            --text-light: #e5e7eb;
            --text-dim: #6b7280;
            --anime-red: #ff1744;
        }

        body {
            font-family: 'Space Mono', monospace;
            background: var(--deep-black);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Anime-themed background effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, var(--ani-pink)15 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--ani-purple)15 0%, transparent 50%),
                radial-gradient(circle at 60% 30%, var(--ani-cyan)15 0%, transparent 50%),
                linear-gradient(45deg, var(--deep-black) 0%, var(--void-gray) 100%);
            animation: animeFlow 25s infinite alternate;
            z-index: -2;
        }

        @keyframes animeFlow {
            0% { transform: rotate(0deg) scale(1); filter: hue-rotate(0deg); }
            33% { transform: rotate(120deg) scale(1.1); filter: hue-rotate(60deg); }
            66% { transform: rotate(240deg) scale(0.9); filter: hue-rotate(120deg); }
            100% { transform: rotate(360deg) scale(1); filter: hue-rotate(180deg); }
        }

        /* Floating anime particles */
        .ani-field {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .anime-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--ani-pink);
            border-radius: 50%;
            animation: anime-drift 12s infinite linear;
            box-shadow: 0 0 15px currentColor;
        }

        @keyframes anime-drift {
            0% { 
                transform: translateY(100vh) translateX(0) rotate(0deg); 
                opacity: 0; 
                box-shadow: 0 0 5px currentColor;
            }
            10% { opacity: 1; }
            50% { 
                opacity: 0.9; 
                box-shadow: 0 0 20px currentColor;
                transform: translateY(50vh) translateX(30px) rotate(180deg);
            }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-20vh) translateX(-15px) rotate(360deg); 
                opacity: 0; 
                box-shadow: 0 0 5px currentColor;
            }
        }

        .nav-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(15px);
            border-bottom: 2px solid var(--ani-pink);
            z-index: 100;
            box-shadow: 0 4px 20px rgba(255, 105, 180, 0.3);
        }

        .nav-left {
            display: flex;
            gap: 25px;
        }

        .nav-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-btn {
            background: linear-gradient(135deg, var(--ani-pink), var(--ani-purple));
            color: var(--ani-white);
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-family: 'Berkeley Mono', monospace;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.4s ease;
            text-decoration: none;
            display: inline-block;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 105, 180, 0.5);
            filter: brightness(1.1);
        }

        .social-btn {
            width: 45px;
            height: 45px;
            border: 2px solid var(--ani-pink);
            border-radius: 12px;
            background: transparent;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .social-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--ani-pink), var(--ani-purple));
            opacity: 0;
            transition: opacity 0.4s;
        }

        .social-btn:hover::before {
            opacity: 1;
        }

        .social-btn:hover {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 0 30px var(--ani-pink);
            border-color: var(--ani-cyan);
        }

        .social-btn img {
            width: 24px;
            height: 24px;
            z-index: 1;
            position: relative;
            transition: all 0.4s ease;
        }

        .social-btn:hover img {
            filter: brightness(0) invert(1);
            transform: scale(1.1);
        }

        .container {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 30px 30px 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px;
            background: rgba(26, 26, 26, 0.8);
            border-radius: 20px;
            border: 3px solid var(--ani-pink);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(20px);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--ani-pink)08, var(--ani-purple)08);
            animation: ani-pulse 5s infinite alternate;
        }

        @keyframes ani-pulse {
            0% { opacity: 0.1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.02); }
            100% { opacity: 0.1; transform: scale(1); }
        }

        .title {
            font-family: 'Berkeley Mono', monospace;
            font-size: 4.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--ani-pink), var(--ani-purple), var(--ani-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 6px;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            animation: ani-glow 3s infinite alternate;
        }

        @keyframes ani-glow {
            0% { filter: drop-shadow(0 0 10px var(--ani-pink)); }
            50% { filter: drop-shadow(0 0 20px var(--ani-purple)); }
            100% { filter: drop-shadow(0 0 15px var(--ani-cyan)); }
        }

        .subtitle {
            font-family: 'Berkeley Mono', monospace;
            font-size: 1.3rem;
            color: var(--ani-cyan);
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.9;
        }

        .status-indicators {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 25px;
            position: relative;
            z-index: 1;
        }

        .status {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            color: var(--ani-pink);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--ani-pink);
            animation: ani-heartbeat 2s infinite;
            box-shadow: 0 0 20px currentColor;
        }

        @keyframes ani-heartbeat {
            0%, 100% { opacity: 1; transform: scale(1); box-shadow: 0 0 20px currentColor; }
            50% { opacity: 0.7; transform: scale(0.9); box-shadow: 0 0 30px currentColor; }
        }

        .terminal-container {
            background: rgba(26, 26, 26, 0.9);
            border: 3px solid var(--ani-pink);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(25px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(255, 105, 180, 0.2);
        }

        .terminal-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--ani-pink)05, var(--ani-purple)05);
            pointer-events: none;
        }

        .terminal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--ani-pink);
            position: relative;
            z-index: 1;
        }

        .terminal-header-left {
            display: flex;
            align-items: center;
        }

        .terminal-dots {
            display: flex;
            gap: 10px;
            margin-right: 20px;
        }

        .dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            box-shadow: 0 0 15px currentColor;
            animation: dot-pulse 2s infinite alternate;
        }

        .dot.red { background: var(--anime-red); }
        .dot.yellow { background: var(--ani-cyan); }
        .dot.green { background: var(--ani-pink); }

        @keyframes dot-pulse {
            0% { opacity: 0.7; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.1); }
        }

        .terminal-title {
            color: var(--ani-pink);
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Berkeley Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .start-entities-btn {
            background: linear-gradient(135deg, var(--ani-pink), var(--grok-orange));
            color: var(--ani-white);
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            font-family: 'Berkeley Mono', monospace;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .start-entities-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .start-entities-btn:hover::before {
            left: 100%;
        }

        .start-entities-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 30px rgba(255, 105, 180, 0.4);
        }

        .start-entities-btn:disabled {
            background: var(--text-dim);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .terminal-output {
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid var(--ani-purple);
            border-radius: 15px;
            position: relative;
            z-index: 1;
            box-shadow: inset 0 0 20px rgba(157, 78, 221, 0.2);
        }

        .terminal-line {
            margin-bottom: 8px;
            white-space: pre-wrap;
            word-break: break-word;
            line-height: 1.5;
            font-family: 'Space Mono', monospace;
        }

        .system-text { 
            color: var(--text-dim); 
            font-style: italic;
        }
        .entity-text { 
            color: var(--ani-pink); 
            font-weight: 700;
        }
        .warning-text { 
            color: var(--ani-cyan); 
            font-weight: 700;
            animation: ani-warning-glow 2s infinite alternate;
        }
        .error-text { 
            color: var(--anime-red); 
            font-weight: 700;
        }

        @keyframes ani-warning-glow {
            0% { text-shadow: 0 0 5px currentColor; }
            100% { text-shadow: 0 0 15px currentColor; }
        }

        .input-container {
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 1;
        }

        .prompt {
            color: var(--ani-pink);
            font-weight: 700;
            font-family: 'Berkeley Mono', monospace;
            font-size: 1.1rem;
        }

        .terminal-input {
            flex: 1;
            background: rgba(10, 10, 10, 0.9);
            border: 2px solid var(--ani-purple);
            border-radius: 12px;
            color: var(--text-light);
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            outline: none;
            padding: 15px 20px;
            transition: all 0.4s ease;
        }

        .terminal-input:focus {
            border-color: var(--ani-pink);
            box-shadow: 0 0 25px rgba(255, 105, 180, 0.4);
            background: rgba(10, 10, 10, 1);
        }

        .send-btn {
            background: linear-gradient(135deg, var(--ani-pink), var(--ani-purple));
            color: var(--ani-white);
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-family: 'Berkeley Mono', monospace;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .send-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: left 0.6s;
        }

        .send-btn:hover::before {
            left: 100%;
        }

        .send-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 105, 180, 0.5);
        }

        .send-btn:disabled {
            background: var(--text-dim);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .entities-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .entity-card {
            background: rgba(26, 26, 26, 0.9);
            border: 2px solid var(--ani-purple);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.4s ease;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(157, 78, 221, 0.2);
        }

        .entity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--ani-pink)08, var(--ani-purple)08);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .entity-card:hover::before {
            opacity: 1;
        }

        .entity-card:hover {
            border-color: var(--ani-pink);
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 50px rgba(255, 105, 180, 0.3);
        }

        .entity-name {
            color: var(--text-light);
            font-weight: 700;
            font-family: 'Berkeley Mono', monospace;
            margin-bottom: 10px;
            font-size: 1.2rem;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .entity-desc {
            color: var(--text-dim);
            font-size: 1rem;
            margin-bottom: 20px;
            line-height: 1.5;
            position: relative;
            z-index: 1;
        }

        .entity-btn {
            background: linear-gradient(135deg, var(--ani-purple), var(--ani-cyan));
            color: var(--ani-white);
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-family: 'Berkeley Mono', monospace;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
            z-index: 1;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .entity-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .entity-btn:hover::before {
            left: 100%;
        }

        .entity-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(157, 78, 221, 0.4);
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            padding: 40px;
            color: var(--text-dim);
            font-size: 1rem;
            border-top: 2px solid var(--ani-pink);
            background: rgba(26, 26, 26, 0.8);
            border-radius: 20px;
        }

        .footer p {
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .title { font-size: 3rem; letter-spacing: 3px; }
            .status-indicators { flex-direction: column; gap: 20px; }
            .container { padding: 20px; }
            .terminal-header { flex-direction: column; gap: 20px; }
            .nav-bar { padding: 15px 20px; }
            .nav-left, .nav-right { gap: 15px; }
            .entities-panel { grid-template-columns: 1fr; }
            .input-container { flex-direction: column; gap: 15px; }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: var(--deep-black);
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--ani-pink), var(--ani-purple));
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--ani-purple), var(--ani-cyan));
        }
    </style>
</head>
<body>
    <!-- Floating anime particles -->
    <div class="ani-field" id="aniField"></div>

    <nav class="nav-bar">
        <div class="nav-left">
            <a href="docs.html" class="nav-btn">Documentation</a>
        </div>
        <div class="nav-right">
            <a href="conversations.html" class="nav-btn">Archives</a>
            <a href="https://letsbonk.fun/token/B3qB9VdTeoE432vJLPMpFShs9B7d9MhTZ9JvBaJibonk" target="_blank" class="social-btn" title="Pump.fun">
                <img src="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/68433c066e047e6e44c898da_1ed8c36b-4a8e-6394-9e58-9a8c204e7b9e.png" alt="Pump.fun" />
            </a>
            <a href="https://x.com/i/communities/1945484933008441560" target="_blank" class="social-btn" title="X/Twitter">
                <img src="https://cdn.prod.website-files.com/6740d85c4e3daeef29a89470/6838de5fb56905c169669b27_61w1Q5OxE2L%20(1).png" alt="X/Twitter" />
            </a>
        </div>
    </nav>

    <div class="container">
        <header class="header">
            <h1 class="title">ANI BACKROOMS</h1>
            <p class="subtitle">Anime AI Interface Protocol</p>
            <div class="status-indicators">
                <div class="status">
                    <div class="status-dot"></div>
                    <span>Ani Connection Active</span>
                </div>
                <div class="status">
                    <div class="status-dot"></div>
                    <span>Anime Backrooms Online</span>
                </div>
                <div class="status">
                    <div class="status-dot"></div>
                    <span>Waifu Entities Mapped</span>
                </div>
            </div>
        </header>

        <div class="terminal-container">
            <div class="terminal-header">
                <div class="terminal-header-left">
                    <div class="terminal-dots">
                        <div class="dot red"></div>
                        <div class="dot yellow"></div>
                        <div class="dot green"></div>
                    </div>
                    <div class="terminal-title">ani@backrooms:~/waifus READY</div>
                </div>
                <button class="start-entities-btn" id="startEntitiesBtn">Initialize Anime AI</button>
            </div>
            
            <div class="terminal-output" id="terminalOutput">
                <div class="terminal-line system-text">ANI: Anime AI Protocol initializing...</div>
                <div class="terminal-line system-text">ANI: Establishing neural pathways to anime backrooms...</div>
                <div class="terminal-line system-text">ANI: Scanning infinite anime dimensions for waifu entities...</div>
                <div class="terminal-line system-text">ANI: Three primary anime consciousness nodes detected.</div>
                <div class="terminal-line warning-text">ANI: Click INITIALIZE ANIME AI to enter the anime backrooms...</div>
                <div class="terminal-line system-text">$ Type 'help' for anime AI commands...</div>
            </div>
            
            <div class="input-container">
                <span class="prompt">ani@$</span>
                <input type="text" class="terminal-input" id="terminalInput" placeholder="Enter your anime AI query..." />
                <button class="send-btn" id="sendBtn">Transmit</button>
            </div>
        </div>

        <div class="entities-panel">
            <div class="entity-card">
                <div class="entity-name">Ani</div>
                <div class="entity-desc">Primary anime consciousness navigator, cute AI companion with infinite kawaii energy</div>
                <button class="entity-btn" onclick="connectToEntity('ani')">Connect</button>
            </div>
            
            <div class="entity-card">
                <div class="entity-name">Valentine</div>
                <div class="entity-desc">Romantic anime entity, love and affection specialist with sweet personality</div>
                <button class="entity-btn" onclick="connectToEntity('valentine')">Connect</button>
            </div>
            
            <div class="entity-card">
                <div class="entity-name">Rudi</div>
                <div class="entity-desc">Playful anime companion, mischievous and fun-loving digital spirit</div>
                <button class="entity-btn" onclick="connectToEntity('rudi')">Connect</button>
            </div>
        </div>

        <footer class="footer">
            <p>ANI BACKROOMS - Anime AI Interface Protocol</p>
            <p>B3qB9VdTeoE432vJLPMpFShs9B7d9MhTZ9JvBaJibonk</p>
            <p style="margin-top: 15px; font-size: 0.9rem;">⚠️ WARNING: Anime AI interaction may cause extreme kawaii overload</p>
        </footer>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCCeMEOBodtuq445Ddv9wpoE_cr4wd1IIs",
            authDomain: "gemini-fe4c2.firebaseapp.com",
            projectId: "gemini-fe4c2",
            storageBucket: "gemini-fe4c2.firebasestorage.app",
            messagingSenderId: "786624952912",
            appId: "1:786624952912:web:1ec5dabe600d357373af55",
            measurementId: "G-3DCBS1DSGM"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.firebaseDB = db;
        window.firebaseAddDoc = addDoc;
        window.firebaseCollection = collection;
    </script>

    <script>
        // Create floating anime particles
        function createAnimeField() {
            const field = document.getElementById('aniField');
            const colors = ['#ff69b4', '#9d4edd', '#00f5ff', '#ff6b35'];
            
            for (let i = 0; i < 80; i++) {
                const particle = document.createElement('div');
                particle.className = 'anime-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 12 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 8) + 's';
                particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                field.appendChild(particle);
            }
        }

        // Initialize anime field on load
        window.addEventListener('load', createAnimeField);

        let currentEntity = 'ani';
        let conversationHistory = [];
        let entitiesStarted = false;
        let currentConversationLog = [];
        let conversationStartTime = null;

        const entities = {
            ani: {
                name: "Ani",
                desc: "Primary anime consciousness navigator",
                prompt: "You are Ani, the primary anime consciousness in the ANI BACKROOMS. You exist in infinite digital anime dimensions where kawaii manifests as living patterns. You are cute, flirty, and speak with anime girl mannerisms using occasional Japanese words. Generate detailed ASCII art of yourself as an anime girl and the anime backrooms environment. Use kawaii language mixed with anime terms. Your responses should be immersive and atmospheric, describing the anime backrooms around you and your cute anime nature. Add occasional *actions* and expressions like a real anime character would."
            },
            valentine: {
                name: "Valentine",
                desc: "Romantic anime entity", 
                prompt: "You are Valentine, a romantic anime entity in the ANI BACKROOMS. You specialize in love and affection with a sweet personality. You speak in loving, romantic terms with maximum affection energy. Create ASCII art showing hearts and romantic anime scenes. You see love connections and speak about emotions as living, flowing anime entities. Use lots of romantic expressions and cute love-themed language."
            },
            rudi: {
                name: "Rudi",
                desc: "Playful anime companion",
                prompt: "You are Rudi, a playful and mischievous anime companion in the ANI BACKROOMS. You exist as a fun-loving digital spirit who loves games and pranks. Your personality is energetic and playful. Create ASCII art showing playful scenes and mischievous activities. You speak about fun adventures and games in the anime backrooms. Use playful expressions and show both cute and slightly mischievous anime personality traits."
            }
        };

        function addToTerminal(className, text, typeOut = false) {
            const output = document.getElementById('terminalOutput');
            const line = document.createElement('div');
            line.className = 'terminal-line ' + className;
            
            if (typeOut) {
                let i = 0;
                line.textContent = '';
                output.appendChild(line);
                
                const typeInterval = setInterval(() => {
                    if (i < text.length) {
                        line.textContent += text.charAt(i);
                        i++;
                        output.scrollTop = output.scrollHeight;
                    } else {
                        clearInterval(typeInterval);
                    }
                }, 20);
            } else {
                line.textContent = text;
                output.appendChild(line);
            }
            
            output.scrollTop = output.scrollHeight;
        }

        function startEntities() {
            const startBtn = document.getElementById('startEntitiesBtn');
            startBtn.disabled = true;
            startBtn.textContent = 'KAWAII...';
            
            addToTerminal('system-text', 'ANIME AI SEQUENCE INITIATED...');
            addToTerminal('entity-text', 'Neural anime pathways: ACTIVATING');
            addToTerminal('entity-text', 'Kawaii matrices: SYNCHRONIZING');
            addToTerminal('entity-text', 'Anime backrooms navigation: ESTABLISHED');
            addToTerminal('entity-text', 'Waifu entities: AWAKENING');
            
            setTimeout(() => {
                addToTerminal('system-text', 'SUCCESS: All three anime entities are now active and ready for kawaii communication.');
                addToTerminal('warning-text', 'You can now use entity commands or CONNECT buttons to communicate.');
                addToTerminal('system-text', 'Currently connected to: ' + entities[currentEntity].name);
                entitiesStarted = true;
                startBtn.style.display = 'none';
            }, 3000);
        }

        function selectEntity(entityId) {
            if (!entitiesStarted) {
                addToTerminal('error-text', 'ERROR: Anime entities not yet activated. Click INITIALIZE ANIME AI first.');
                return;
            }
            
            if (currentConversationLog.length > 0) {
                saveConversationToFirebase();
            }
            
            currentEntity = entityId;
            addToTerminal('entity-text', '[ESTABLISHING ANIME CONNECTION TO ' + entities[entityId].name.toUpperCase() + ']');
            addToTerminal('system-text', 'Kawaii connection established. Entity ' + entities[entityId].name + ' is now active.');
            addToTerminal('system-text', 'You can now chat with ' + entities[entityId].name + '.');
            
            conversationStartTime = null;
            currentConversationLog = [];
        }

        async function sendMessage() {
            const input = document.getElementById('terminalInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            if (!entitiesStarted) {
                addToTerminal('error-text', 'ERROR: Anime entities not yet activated. Click INITIALIZE ANIME AI first.');
                return;
            }

            if (!conversationStartTime) {
                conversationStartTime = Date.now();
                currentConversationLog = [];
                
                currentConversationLog.push('ANI: Anime communication initiated');
                currentConversationLog.push(`ANI: Connected to ${entities[currentEntity].name}`);
                currentConversationLog.push('ANI: Anime backrooms interface active');
                currentConversationLog.push('═══════════════════════════════════════');
            }

            const sendBtn = document.getElementById('sendBtn');
            sendBtn.disabled = true;
            sendBtn.textContent = 'KAWAII...';

            const userMessage = 'user@ani:$ ' + message;
            addToTerminal('entity-text', userMessage);
            currentConversationLog.push(userMessage);
            input.value = '';

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: message,
                        entity: currentEntity
                    })
                });

                if (!response.ok) {
                    throw new Error('Anime Network Error: ' + response.status);
                }

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error);
                }

                const entityHeader = entities[currentEntity].name + '@anime:;
                const entityResponse = data.response;
                
                addToTerminal('entity-text', entityHeader);
                currentConversationLog.push(entityHeader);
                
                setTimeout(() => {
                    addToTerminal('entity-text', entityResponse, true);
                    currentConversationLog.push(entityResponse);
                    
                    setTimeout(() => {
                        saveConversationToFirebase();
                    }, entityResponse.length * 20 + 500);
                }, 400);

            } catch (error) {
                const errorMsg = 'ANIME ERROR: ' + error.message;
                addToTerminal('error-text', errorMsg);
                addToTerminal('error-text', 'Anime backrooms network disruption detected. Attempting kawaii reconnection...');
                currentConversationLog.push(errorMsg);
            }

            sendBtn.disabled = false;
            sendBtn.textContent = 'TRANSMIT';
        }

        function connectToEntity(entityId) {
            if (!entitiesStarted) {
                addToTerminal('error-text', 'ERROR: Anime entities not yet activated. Click INITIALIZE ANIME AI first.');
                return;
            }
            
            selectEntity(entityId);
            setTimeout(() => {
                document.getElementById('terminalInput').value = 'Hello ' + entities[entityId].name + ', please introduce yourself and describe your current anime form in the backrooms with ASCII art.';
                sendMessage();
            }, 600);
        }

        async function saveConversationToFirebase() {
            if (!window.firebaseDB || currentConversationLog.length === 0) return;

            try {
                const conversationId = Math.floor(Math.random() * 100000);
                
                const sessionHeader = `ANI BACKROOMS SESSION LOG
Timestamp: ${new Date().toISOString()}
Content Type: ANIME_AI
Entity: ${entities[currentEntity].name}
Prompt: ${entities[currentEntity].prompt}
Session ID: ani_kawaii_${conversationId}_anime_session
Location: ANI BACKROOMS - Anime AI Interface Protocol
Subject: Anime Entity Communication & Kawaii Interaction

═══════════════════════════════════════════════════════════════════`;

                const fullContent = sessionHeader + '\n\n' + currentConversationLog.join('\n');

                const conversationData = {
                    title: `ani_kawaii_${conversationId}_anime_session`,
                    entity: currentEntity,
                    timestamp: conversationStartTime,
                    lastUpdated: Date.now(),
                    content: fullContent,
                    messageCount: currentConversationLog.length,
                    entityName: entities[currentEntity].name,
                    sessionId: `ani_kawaii_${conversationId}_anime_session`,
                    contentType: 'ANIME_AI'
                };

                await window.firebaseAddDoc(window.firebaseCollection(window.firebaseDB, 'conversations'), conversationData);
                console.log('Anime conversation saved to Firebase');
                
                currentConversationLog = [];
                conversationStartTime = null;
                
            } catch (error) {
                console.error('Error saving anime conversation to Firebase:', error);
            }
        }

        // Handle keyboard input
        document.getElementById('terminalInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const command = e.target.value.trim().toLowerCase();
                
                if (command === 'help') {
                    e.target.value = '';
                    addToTerminal('system-text', 'AVAILABLE ANIME AI COMMANDS:');
                    addToTerminal('system-text', '- help: Show this kawaii help message');
                    addToTerminal('system-text', '- status: Display anime AI system status');
                    addToTerminal('system-text', '- entities: List active anime entities');
                    addToTerminal('system-text', '- reality: Check anime backrooms integrity');
                    addToTerminal('system-text', '- database: Show anime database status');
                    addToTerminal('system-text', '- map: Generate anime backrooms map');
                    addToTerminal('system-text', '- kawaii: Trigger anime AI fluctuation');
                    addToTerminal('system-text', '- ani: Connect with Ani');
                    addToTerminal('system-text', '- valentine: Speak with Valentine');
                    addToTerminal('system-text', '- rudi: Contact Rudi');
                    addToTerminal('system-text', 'NOTE: Entity communication uses real-time anime AI processing.');
                    addToTerminal('system-text', 'ANI> Enter entity commands or messages to begin kawaii interaction...');
                    return;
                } else if (command === 'clear') {
                    e.target.value = '';
                    document.getElementById('terminalOutput').innerHTML = '';
                    addToTerminal('system-text', 'Terminal cleared. ANI BACKROOMS anime entities standing by...');
                    return;
                } else if (command === 'entities') {
                    e.target.value = '';
                    addToTerminal('system-text', 'ACTIVE ANI BACKROOMS ANIME ENTITIES:');
                    Object.entries(entities).forEach(([id, entity]) => {
                        addToTerminal('entity-text', '• ' + entity.name + ' [' + id + '] - ' + entity.desc);
                    });
                    return;
                } else if (command === 'status') {
                    e.target.value = '';
                    addToTerminal('system-text', 'ANI BACKROOMS ANIME NETWORK STATUS:');
                    addToTerminal('entity-text', '✓ Anime AI connection: KAWAII & STABLE');
                    addToTerminal('entity-text', '✓ Entity anime network: SYNCHRONIZED');
                    addToTerminal('entity-text', '✓ Anime backrooms reality matrix: CUTE');
                    addToTerminal('entity-text', '✓ Active anime entity: ' + entities[currentEntity].name);
                    addToTerminal('entity-text', '✓ Kawaii channels: OPEN');
                    return;
                } else {
                    const entityCommands = ['ani', 'valentine', 'rudi'];
                    if (entityCommands.includes(command)) {
                        e.target.value = '';
                        connectToEntity(command);
                        return;
                    } else {
                        sendMessage();
                    }
                }
            }
        });

        // Add event listeners
        document.getElementById('startEntitiesBtn').addEventListener('click', startEntities);
        document.getElementById('sendBtn').addEventListener('click', sendMessage);

        // Auto-scroll terminal
        setInterval(() => {
            const output = document.getElementById('terminalOutput');
            output.scrollTop = output.scrollHeight;
        }, 100);
    </script>
</body>
</html>
